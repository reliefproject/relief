<!doctype>
<html ng-app="Account">

  <head>

    <!--<link href="./css/font-awesome.min.css" rel="stylesheet">-->
    <link href="../../node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="../../html/stylesheets/photon.css" rel="stylesheet">
    <link href="./css/stylesheet.css" rel="stylesheet">

    <script src="../../node_modules/jquery/dist/jquery.js"></script>
    <script src="../../node_modules/bootstrap/dist/js/bootstrap.js"></script>
    <script src="../../node_modules/angular/angular.js"></script>
    <script src="../../node_modules/angular-sanitize/angular-sanitize.js"></script>

    <script src="./js/start.js"></script>

<script>

/*
  Relief.event.on('test', function(data) {
    console.log('test renderer');
    console.log(data);
  });


$(document).ready(function() {


console.log(Relief.blockchain);

  $('#loginForm').submit(function(e) {
    // TODO Load user profile from username/password
    e.preventDefault();

    var username = $('#username').val();
    var password = $('#password').val();

    Relief.session.login(username, password, function(success) {
console.log(success);
      if (success) {
        Relief.event.emit('loggedIn');
      }
    });


  });

  $('#createAccountForm').submit(function(e) {

    e.preventDefault();
    var username = $('#username').val();
    var password = $('#password').val();
    var encryptionPassword = $('#encryptionPassword').val();
    Relief.session.createUser(username, password);

  });

});
*/
</script>

  </head>
  <body ng-controller="MainCtrl" ng-show="finishedLoading">

    <div class="modal" id="serverListElectrum" tabindex="-1" role="dialog" data-backdrop="false">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">{{ strings.LIST_ELECTRUM_TITLE }}</h4>
          </div>
          <div class="modal-body">

            <table class="table table-condensed table-hover table-fixed">
              <thead>
                <tr>
                  <th class="col-xs-2">{{ strings.PROTOCOL }}</th>
                  <th class="col-xs-6">{{ strings.HOSTNAME }}</th>
                  <th class="col-xs-2">{{ strings.PORT }}</th>
                  <th class="col-xs-2">{{ strings.LIMIT }}</th>
                </tr>
              </thead>
              <tbody>
                <tr ng-repeat="(key, server) in servers.electrum"
                    ng-click="selectElectrumServer(server)"
                    data-dismiss="modal">
                  <td class="col-xs-2">{{ server.protocol }}</td>
                  <td class="col-xs-6">{{ server.host }}</td>
                  <td class="col-xs-2">{{ server.port }}</td>
                  <td class="col-xs-2">{{ server.limit }}</td>
                </tr>
              </tbody>
            </table>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">{{ BTN_CLOSE }}</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->


    <div class="modal" id="serverListNxt" tabindex="-1" role="dialog" data-backdrop="false">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">{{ strings.LIST_NXT_TITLE }}</h4>
          </div>
          <div class="modal-body">

            <table class="table table-condensed table-hover table-fixed">
              <thead>
                <tr>
                  <th class="col-xs-2">{{ strings.PROTOCOL }}</th>
                  <th class="col-xs-6">{{ strings.HOSTNAME }}</th>
                  <th class="col-xs-2">{{ strings.PORT }}</th>
                  <th class="col-xs-2"></th>
                </tr>
              </thead>
              <tbody>
                <tr ng-repeat="(key, server) in servers.nxt"
                    ng-click="selectNxtServer(server)"
                    data-dismiss="modal">
                  <td class="col-xs-2">{{ server.protocol }}</td>
                  <td class="col-xs-6">{{ server.host }}</td>
                  <td class="col-xs-2">{{ server.port }}</td>
                  <td class="col-xs-2"></td>
                </tr>
              </tbody>
            </table>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">{{ strings.BTN_CLOSE }}</button>
            <button type="button" class="btn btn-primary">{{ strings.BTN_OK }}</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->


    <div class="container" style="padding-top:10px;">

      <ul class="nav nav-tabs nav-justified">
        <li role="presentation" ng-class="{ active: selectedTab == 'login'}">
          <a href="#" ng-click="selectedTab = 'login'">{{ strings.TAB_LOGIN }}</a>
        </li>
        <li role="presentation" ng-class="{ active: selectedTab == 'create'}">
          <a href="#" ng-click="selectedTab = 'create'">{{ strings.TAB_CREATE }}</a>
        </li>
      </ul>

      <div class="row" ng-show="selectedTab == 'login'" style="padding:10px;">

        <div class="col-md-6">
          <div class="panel panel-default">
            <div class="panel-heading">{{ strings.PANEL_LOGIN_TITLE }}</div>
            <div class="panel-body small">
              <span ng-bind-html='strings.PANEL_LOGIN_TEXT'></span>
            </div>
          </div>
      </div>

      <div class="col-md-6">
        <form name="loginForm" novalidate
              ng-submit="submitLoginForm()">

          <div class="alert alert-danger" role="alert"
               ng-show="loginForm.$submitted && loginForm.$invalid">
            <span class="fa fa-fw fa-exclamation-circle" aria-hidden="true"></span>
            {{ strings.FORM_ERROR }}
          </div>

          <div class="alert alert-success" role="alert"
               ng-show="createAccountSuccess">
            <span class="fa fa-fw fa-check-circle" aria-hidden="true"></span>
            {{ strings.CREATE_SUCCESS }}
          </div>

          <div class="form-group">
            <label>{{ strings.LANGUAGE }}</label>
            <select class="form-control"
                    ng-options="language.id as language.name for language in languages" ng-model='login.language' required>
            </select>
          </div>

          <div class="form-group" ng-class="{'has-error': loginForm.username.$touched && loginForm.username.$invalid }">
            <label>{{ strings.USERNAME }}</label>
            <input type="text" class="form-control" name="username"
                   ng-model="login.username" ng-pattern="'^[a-zA-Z0-9\-\s]+$'" required>
            <span class="help-block" ng-show="loginErrorUsername">{{ loginErrorUsername }}</span>
          </div>

          <div class="form-group" ng-class="{'has-error': loginForm.password.$touched && loginForm.password.$invalid }">
            <label>{{ strings.PASSWORD }}</label>
            <input type="password" class="form-control" name="password"
                   ng-model="login.password" ng-minlength="10" required>
            <span class="help-block" ng-show="loginErrorPassword">{{ loginErrorPassword }}</span>
          </div>

          <div class="form-group">
            <a href="#" ng-click="showAdvSettingsLogin = (showAdvSettingsLogin == true) ? false : true">
              <span class="caret"></span> {{ strings.SERVER_SETTINGS }}
            </a>
          </div>

          <label ng-show="showAdvSettingsLogin == true">{{ strings.ELECTRUM }}</label>

          <div class="form-group form-inline"
               ng-show="showAdvSettingsLogin == true"
               ng-class="{'has-error': (loginForm.electrumHost.$touched && loginForm.electrumHost.$invalid) ||
                                       (loginForm.electrumPort.$touched && loginForm.electrumPort.$invalid) }">

            <select class="form-control" name="electrumProtocol" style="min-width:105px"
                    ng-model='login.electrum.protocol' required>
              <option value="tls">TLS</option>
              <option value="tcp">TCP</option>
            </select>

            <input type="text" class="form-control" name="electrumHost" placeholder="Hostname" size="12"
                   ng-model="login.electrum.host" required />

            <input type="text" class="form-control" name="electrumPort" placeholder="Port" size="5"
                   ng-model="login.electrum.port" required />

            <a href="#" type="button" class="btn btn-primary" data-toggle="modal" data-target="#serverListElectrum">
              <span class="fa fa-fw fa-list"></span> &nbsp;
            </a>

            <div class="help-block">
              <div class="checkbox">
                <label>
                  <input type="checkbox" ng-model="login.electrum.remember">
                  {{ strings.REMEMBER_SERVER }}
                </label>
              </div>
            </div>
            <span class="help-block" ng-show="loginErrorElectrum">{{ loginErrorElectrum }}</span>

          </div>

          <label ng-show="showAdvSettingsLogin == true">{{ strings.NXT }}</label>
          <div class="form-group form-inline"
               ng-show="showAdvSettingsLogin == true"
               ng-class="{'has-error': (loginForm.nxtHost.$touched && loginForm.nxtHost.$invalid) ||
                                       (loginForm.nxtPort.$touched && loginForm.nxtPort.$invalid) }">

            <select class="form-control" name="nxtProtocol"
                    ng-model='login.nxt.protocol' required>
              <option value="https">HTTPS</option>
              <option value="http">HTTP</option>
            </select>

            <input type="text" class="form-control" name="nxtHost" placeholder="Hostname" size="12"
                   ng-model="login.nxt.host" required>

            <input type="text" class="form-control" name="nxtPort" placeholder="Port" size="5"
                   ng-model="login.nxt.port" required>

            <a href="#" type="button" class="btn btn-primary" data-toggle="modal" data-target="#serverListNxt">
              <span class="fa fa-fw fa-list"></span>&nbsp;
            </a>

            <div class="help-block">
              <div class="checkbox">
                <label>
                  <input type="checkbox" ng-model="login.nxt.remember">
                  {{ strings.REMEMBER_SERVER }}
                </label>
              </div>
            </div>
            <span class="help-block" ng-show="loginErrorNxt">{{ loginErrorNxt }}</span>

          </div>

          <button type="submit" class="btn btn-default">{{ strings.BTN_CONTINUE }}</button>
          <img src="../../html/img/default.svg" style="width:30px; height:30px;"
               ng-show="loginForm.$submitted && loginForm.$valid" />
        </form>

      </div>

    </div>


    <div class="row" ng-show="selectedTab == 'create'" style="padding:10px;">

        <div class="col-md-6">

          <div class="progress">
            <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40"
                 aria-valuemin="0" aria-valuemax="100"
                 ng-class="'progress' + createFormStep">
              {{ strings.STEP }} {{ createFormStep }} / 6
            </div>
          </div>

          <div class="panel panel-default"
               ng-show="createFormStep == 1">
            <div class="panel-heading">{{ strings.PANEL_CREATE1_TITLE }}</div>
            <div class="panel-body small">
              <span ng-bind-html='strings.PANEL_CREATE1_TEXT'></span>
              <ul>
                <li>
                  <a href="#">Documentation</a>
                </li>
                <li>
                  <a href="#">Forum <span class="fa fa-fw fa-external-link"></span></a>
                </li>
              </ul>
            </div>
          </div>


          <div class="panel panel-default"
               ng-show="createFormStep == 2">
            <div class="panel-heading">{{ strings.PANEL_CREATE2_TITLE }}</div>
            <div class="panel-body small">
                <span ng-bind-html='strings.PANEL_CREATE2_TEXT'></span>
            </div>
          </div>


          <div class="panel panel-default"
               ng-show="createFormStep == 3">
            <div class="panel-heading">{{ strings.PANEL_CREATE2_TITLE }}</div>
            <div class="panel-body small">
                <span ng-bind-html='strings.PANEL_CREATE3_TEXT'></span>
            </div>
          </div>


          <div class="panel panel-default"
               ng-show="createFormStep == 4">
            <div class="panel-heading">{{ strings.PANEL_CREATE4_TITLE }}</div>
            <div class="panel-body small">
              <span ng-bind-html='strings.PANEL_CREATE4_TEXT'></span>
            </div>
          </div>

          <div class="panel panel-default"
               ng-show="createFormStep == 5">
            <div class="panel-heading">{{ strings.PANEL_CREATE4_TITLE }}</div>
            <div class="panel-body small">
              <span ng-bind-html='strings.PANEL_CREATE5_TEXT'></span>
            </div>
          </div>

          <div class="panel panel-default"
               ng-show="createFormStep == 6">
            <div class="panel-heading">{{ strings.PANEL_CREATE6_TITLE }}</div>
            <div class="panel-body small">
              <span ng-bind-html='strings.PANEL_CREATE6_TEXT'></span>
            </div>
          </div>

      </div>

      <div class="col-md-6">


        <form name="createFormStep1" novalidate
              ng-submit="submitCreateFormStep1()"
              ng-show="createFormStep == 1">

          <div class="alert alert-danger" role="alert"
               ng-show="createFormStep1.$submitted && createFormStep1.$invalid">
            <span class="fa fa-fw fa-exclamation-circle" aria-hidden="true"></span>
            {{ strings.FORM_ERROR }}
          </div>


          <div class="form-group">
            <label>{{ strings.LANGUAGE }}</label>
            <select class="form-control"
            ng-options="language.id as language.name for language in languages" ng-model='create.language' required>
            </select>
          </div>

          <div class="form-group" ng-class="{'has-error': createFormStep1.username.$touched && createFormStep1.username.$invalid }">
            <label>{{ strings.USERNAME }}</label>
            <input type="text" class="form-control" name="username" placeholder="{{ strings.ALPHANUM_SPACES }}"
                   ng-model="create.username" ng-pattern="'^[a-zA-Z0-9\-\s]+$'" required>
            <span class="help-block" ng-show="createErrorUsername">{{ createErrorUsername }}</span>
          </div>

          <div class="form-group" ng-class="{'has-error': createFormStep1.password1.$touched && createFormStep1.password1.$invalid }">
            <label>{{ strings.PASSWORD }}</label>
            <input type="password" class="form-control" name="password1" placeholder="{{ strings.MINLENGTH_10 }}"
                   ng-model="create.password1" ng-minlength="10" required>
            <span class="help-block" ng-show="createErrorPassword1">{{ createErrorPassword1 }}</span>
          </div>

          <div class="form-group"
                ng-class="{'has-error': createFormStep1.password2.$touched &&
                                        (createFormStep1.password2.$invalid || !createFormStep1.password2.$match )
                          }">
            <label>{{ strings.PASSWORD_REPEAT }}</label>
            <input type="password" class="form-control" name="password2" placeholder=""
                   ng-model="create.password2" ng-minlength="10" required>
            <span class="help-block" ng-show="createErrorPassword2">{{ createErrorPassword2 }}</span>
          </div>


          <button type="submit" class="btn btn-default">{{ strings.BTN_CONTINUE }}</button>
        </form>


        <form name="createFormStep2" novalidate
              ng-submit="submitCreateFormStep2()"
              ng-show="createFormStep == 2">

          <div class="alert alert-danger" role="alert"
               ng-show="createFormStep2.$submitted && createFormStep2.$invalid">
            <span class="fa fa-fw fa-exclamation-circle" aria-hidden="true"></span>
            {{ strings.FORM_ERROR }}
          </div>


          <div class="form-group" ng-class="{'has-error': createFormStep2.btcSeed.$touched && createFormStep2.btcSeed.$invalid }">
            <label>{{ strings.PASSPHRASE }}</label>
            <textarea class="form-control" name="btcSeed" rows="5"
                      ng-model="create.btcSeed1" ng-minlength="30" required>
            </textarea>
            <span class="help-block" ng-show="createErrorBtcSeed1">{{ createErrorBtcSeed1 }}</span>
          </div>

          <button type="button" class="btn btn-default"
                  ng-click="createFormStep = (createFormStep - 1)">{{ strings.BTN_BACK }}</button>
          <button type="submit" class="btn btn-default">{{ strings.BTN_CONTINUE }}</button>
          <button type="button" class="btn btn-default"
                  ng-click="generateBtcSeed()">{{ strings.BTN_GENERATE }}</button>


        </form>


        <form name="createFormStep3" novalidate
              ng-submit="submitCreateFormStep3()"
              ng-show="createFormStep == 3">

          <div class="alert alert-danger" role="alert"
               ng-show="createFormStep3.$submitted && createFormStep3.$invalid">
            <span class="fa fa-fw fa-exclamation-circle" aria-hidden="true"></span>
            {{ strings.FORM_ERROR }}
          </div>


          <div class="form-group" ng-class="{'has-error': createFormStep3.btcSeed.$touched &&
                                                          (createFormStep3.btcSeed.$invalid || createFormStep3.btcSeed.$match)
                                            }">
            <label>{{ strings.PASSPHRASE_REPEAT }}</label>
            <textarea class="form-control" name="btcSeed" rows="5"
                      ng-model="create.btcSeed2" ng-minlength="30" required>
            </textarea>
            <span class="help-block" ng-show="createErrorBtcSeed2">{{ createErrorBtcSeed2 }}</span>
          </div>

          <button type="button" class="btn btn-default"
                  ng-click="createFormStep = (createFormStep - 1)">{{ strings.BTN_BACK }}</button>
          <button type="submit" class="btn btn-default">{{ strings.BTN_CONTINUE}}</button>

        </form>

        <form name="createFormStep4" novalidate
              ng-submit="submitCreateFormStep4()"
              ng-show="createFormStep == 4">

          <div class="alert alert-danger" role="alert"
               ng-show="createFormStep4.$submitted && createFormStep4.$invalid">
            <span class="fa fa-fw fa-exclamation-circle" aria-hidden="true"></span>
            {{ strings.FORM_ERROR }}
          </div>


          <div class="form-group" ng-class="{'has-error': createFormStep4.nxtPhrase.$touched && createFormStep4.nxtPhrase.$invalid }">
            <label>{{ strings.PASSPHRASE }}</label>
            <textarea class="form-control" name="nxtPhrase" rows="5"
                      ng-model="create.nxtPhrase1" ng-minlength="30" required>
            </textarea>
            <span class="help-block" ng-show="createErrorNxtPhrase1">{{ createErrorNxtPhrase1 }}</span>
          </div>


          <button type="button" class="btn btn-default"
                  ng-click="createFormStep = (createFormStep - 1)">{{ strings.BTN_BACK }}</button>
          <button type="submit" class="btn btn-default">{{ strings.BTN_CONTINUE }}</button>
          <button type="button" class="btn btn-default"
                  ng-click="generateNxtPhrase()">{{ strings.BTN_GENERATE }}</button>


        </form>


        <form name="createFormStep5" novalidate
              ng-submit="submitCreateFormStep5()"
              ng-show="createFormStep == 5">

          <div class="alert alert-danger" role="alert"
               ng-show="createFormStep5.$submitted && createFormStep5.$invalid">
            <span class="fa fa-fw fa-exclamation-circle" aria-hidden="true"></span>
            {{ strings.FORM_ERROR }}
          </div>


          <div class="form-group" ng-class="{'has-error': createFormStep5.btcSeed.$touched &&
                                                          (createFormStep5.btcSeed.$invalid || createFormStep5.btcSeed.$match)
                                            }">
            <label>{{ strings.PASSPHRASE_REPEAT }}</label>
            <textarea class="form-control" name="nxtPhrase" rows="5"
                      ng-model="create.nxtPhrase2" ng-minlength="30" required>
            </textarea>
            <span class="help-block" ng-show="createErrorNxtPhrase2">{{ createErrorNxtPhrase2 }}</span>
          </div>

          <button type="button" class="btn btn-default"
                  ng-click="createFormStep = (createFormStep - 1)">{{ strings.BTN_BACK }}</button>
          <button type="submit" class="btn btn-default">{{ strings.BTN_CONTINUE }}</button>

        </form>

        <div ng-show="createFormStep == 6">
          <dl class="dl-horizontal">

              <dt>{{ strings.USERNAME }}</dt>
              <dd>{{ create.username }}</dd>

              <dt>{{ strings.PASSWORD }}</dt>
              <dd>[{{ strings.HIDDEN }}]</dd>

              <dt>{{ strings.PASSPHRASE_BTC }}</dt>
              <dd>{{ create.btcSeed1 }}</dd>

              <dt>{{ strings.PASSPHRASE_NXT }}</dt>
              <dd>{{ create.nxtPhrase1 }}</dd>
          </dl>

          <button type="button" class="btn btn-default"
                  ng-click="createFormStep = (createFormStep - 1)">{{ strings.BTN_BACK }}</button>

          <button type="button" class="btn btn-default"
                  ng-click="createAccountEnd()">{{ strings.BTN_CREATE_ACCOUNT }}</button>
        </div>


        </div>
      </div>
    </div>

  </body>
</html>
